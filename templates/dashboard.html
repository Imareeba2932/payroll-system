<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dashboard — PayrollPro</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{
    --bg: #f5f7fb;
    --card: #ffffff;
    --muted: #6c757d;
    --primary: #0b6efd;
    --accent: #6c757d;
    --radius:16px;
    --shadow: 0 12px 30px rgba(0,0,0,0.08);
}

/* Reset */
*{box-sizing:border-box;}
body{
    margin:0;
    font-family: 'Inter', sans-serif;
    background: var(--bg);
    color: #333;
}

/* Header */
header{
    background: var(--card);
    padding:16px 24px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    box-shadow:0 3px 12px rgba(0,0,0,0.06);
    border-bottom:1px solid rgba(0,0,0,0.05);
}
.brand{
    font-weight:800;
    font-size:1.5rem;
    color: var(--primary);
    text-decoration:none;
}
.nav-links a{
    margin-left:12px;
    text-decoration:none;
    font-weight:500;
    padding:8px 14px;
    border-radius:10px;
    transition:0.3s;
    color: #495057;
}
.nav-links a:hover{
    background: var(--primary);
    color:#fff;
}

/* Buttons */
.btn-primary{
    background: linear-gradient(90deg,var(--primary),var(--accent));
    color:#fff;
    padding:8px 16px;
    border-radius:12px;
    text-decoration:none;
    font-weight:600;
    transition:0.3s;
}
.btn-primary:hover{
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(11,110,253,0.3);
}
.btn-ghost{
    background: transparent;
    color: var(--primary);
    border: 1px solid rgba(11,110,253,0.3);
    padding:8px 12px;
    border-radius:10px;
    text-decoration:none;
    font-weight:600;
}

/* Main Layout */
main{
    display:grid;
    grid-template-columns: 2fr 1fr;
    max-width:1200px;
    margin:32px auto;
    padding:0 20px;
    gap:24px;
}

/* Left Column - Stats + Charts + Table */
.left-col{
    display:flex;
    flex-direction:column;
    gap:20px;
}
.stat-cards{
    display:grid;
    grid-template-columns: repeat(3, 1fr);
    gap:20px;
}
.stat-card{
    background: #ffffff;
    padding:24px;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    border: 1px solid #eef1f5;
    transition: transform 0.3s, box-shadow 0.3s;
}
.stat-card:hover{
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}
.stat-card h3{
    margin:0;
    font-size:0.95rem;
    color: var(--muted);
    font-weight:600;
}
.stat-card .value{
    font-size:2rem;
    font-weight:800;
    margin-top:10px;
    color: var(--primary);
}
.stat-trend{ font-size:0.85rem; color:#198754; margin-top:6px; }

/* Panels */
.panel{
    background: var(--card);
    border-radius: var(--radius);
    padding:22px;
    box-shadow: var(--shadow);
    transition: transform 0.3s;
    border: 1px solid #eef1f5;
}
.panel:hover{ transform: translateY(-3px); }
.panel-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:16px;
}
.panel-header h3{ margin:0; font-size:1.1rem; }
.panel-header p{ margin:4px 0 0; color: var(--muted); font-size:0.9rem; }

/* Filters Toolbar */
.toolbar{ display:flex; gap:10px; align-items:center; }
.select{ border:1px solid #dee2e6; border-radius:10px; padding:8px 10px; background:#fff; color:#333; }

/* Chart */
.chart{ display:flex; align-items:end; gap:12px; height:260px; }
.chart-bar-wrapper{ display:flex; flex-direction:column; align-items:center; gap:6px; flex:1; }
.chart-bar{
    width:100%;
    background: linear-gradient(180deg,var(--primary),var(--accent));
    border-radius:8px 8px 0 0;
    display:flex; align-items:flex-end; justify-content:center;
    position:relative; transition:0.3s;
}
.chart-bar:hover{ transform: scaleY(1.05); background: linear-gradient(180deg,var(--accent),var(--primary)); }
.bar-label{ color:#fff; font-size:0.75rem; padding:3px 5px; border-radius:4px; position:absolute; top:-28px; background: rgba(0,0,0,0.35); }
.bar-month{ font-size:0.78rem; color:var(--muted); margin-top:6px; }
.chart-summary{ display:flex; gap:20px; margin-top:14px; color:#495057; font-size:0.95rem; }
.chart-summary .item strong{ color:#0b6efd; }

/* Table */
table{ width:100%; border-collapse:collapse; font-size:0.95rem; }
th, td{ padding:12px; text-align:left; border-bottom:1px solid rgba(0,0,0,0.08); }
th{ color: var(--muted); font-weight:600; }
td{ color: #333; }
.no-data{ text-align:center; color: var(--muted); }

/* Right Sidebar */
.sidebar{ display:flex; flex-direction:column; gap:20px; }
.quick-actions .actions{ display:grid; grid-template-columns: 1fr; gap:10px; }
.badge{ display:inline-block; padding:4px 10px; border-radius:999px; font-size:0.75rem; background:#e9f5ff; color:#0b6efd; border:1px solid rgba(11,110,253,0.2); }
.health-list{ display:flex; flex-direction:column; gap:10px; }
.health-item{ display:flex; justify-content:space-between; align-items:center; padding:10px 12px; border:1px solid #eef1f5; border-radius:10px; }
.health-item .ok{ color:#198754; }
.health-item .warn{ color:#d39e00; }

/* Responsive */
@media(max-width:1000px){
    main{ grid-template-columns: 1fr; }
    .stat-cards{ grid-template-columns: 1fr; }
    .chart{ height:200px; }
}
</style>
</head>
<body>
<!-- Header -->
<header>
    <a class="brand" href="#">PayrollPro</a>
    <div class="nav-links">
        <a href="{{ url_for('view_employees') }}">Employees</a>
        <a href="{{ url_for('generate_salary') }}">Generate</a>
        <a href="{{ url_for('logout') }}">Logout</a>
    </div>
</header>

<!-- Main -->
<main>
    <!-- Left Column -->
    <div class="left-col">
        <div class="stat-cards">
            <div class="stat-card">
                <h3>Total Employees</h3>
                <div class="value">{{ stats.total_employees }}</div>
                <div class="stat-trend">▲ Active this month</div>
            </div>
            <div class="stat-card">
                <h3>Total Payrolls</h3>
                <div class="value">{{ stats.total_payrolls }}</div>
                <div class="stat-trend">▲ Processed recently</div>
            </div>
            <div class="stat-card">
                <h3>Total Paid</h3>
                <div class="value">${{ "{:.2f}".format(stats.total_paid) }}</div>
                <div class="stat-trend">▲ Cumulative</div>
            </div>
        </div>

        <div class="panel">
            <div class="panel-header">
                <div>
                    <h3>Payroll in last 6 months</h3>
                    <p>Monthly net salary totals</p>
                </div>
                <div class="toolbar">
                    <select class="select">
                        <option>Last 6 months</option>
                        <option>Last 12 months</option>
                        <option>Year to Date</option>
                    </select>
                    <a class="btn-ghost" href="{{ url_for('generate_salary') }}">Quick Generate</a>
                </div>
            </div>
            <div class="chart">
                {%- for d in chart_data %}
                <div class="chart-bar-wrapper">
                    <div class="chart-bar" style="height: {{ d.h }}%;" title="{{ d.label }}">
                        <span class="bar-label">{{ d.formatted }}</span>
                    </div>
                    <span class="bar-month">{{ d.label.split(' ')[0] }}</span>
                </div>
                {%- endfor %}
            </div>
            <div class="chart-summary">
                <div class="item">Total: <strong>${{ "{:.2f}".format(chart_values|sum) }}</strong></div>
                <div class="item">Max: <strong>${{ "{:.2f}".format(chart_values|max) }}</strong></div>
                <div class="item">Avg: <strong>${{ "{:.2f}".format((chart_values|sum) / (chart_values|length if chart_values|length else 1)) }}</strong></div>
            </div>
        </div>

        <div class="panel">
            <h3>Recent Employees</h3>
            <table>
                <thead>
                    <tr><th>#</th><th>Name</th><th>Department</th><th>Role</th></tr>
                </thead>
                <tbody>
                    {% for emp in recent_employees %}
                    <tr>
                        <td>{{ emp.id }}</td>
                        <td>{{ emp.name }}</td>
                        <td>{{ emp.department }}</td>
                        <td>{{ emp.role }}</td>
                    </tr>
                    {% endfor %}
                    {% if recent_employees|length == 0 %}
                    <tr><td colspan="4" class="no-data">No recent employees.</td></tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Right Sidebar -->
    <aside class="sidebar">
        <div class="panel quick-actions">
            <div class="panel-header"><h3>Quick Actions</h3></div>
            <div class="actions">
                <a class="btn-primary" href="{{ url_for('add_employee') }}">Add Employee</a>
                <a class="btn-primary" href="{{ url_for('generate_salary') }}">Generate Salary</a>
                <a class="btn-primary" href="{{ url_for('view_salaries') }}">View Salaries</a>
            </div>
        </div>

        <div class="panel">
            <div class="panel-header"><h3>Announcements</h3><span class="badge">New</span></div>
            <ul style="margin:0; padding-left:16px; color:#495057; line-height:1.6;">
                <li>Dashboard UI refreshed for clarity.</li>
                <li>Salary chart now shows percentages with totals.</li>
                <li>Quick actions added for faster workflows.</li>
            </ul>
        </div>

        <div class="panel">
            <div class="panel-header"><h3>System Health</h3></div>
            <div class="health-list">
                <div class="health-item"><span>Database</span><span class="ok">● OK</span></div>
                <div class="health-item"><span>Background Jobs</span><span class="ok">● OK</span></div>
                <div class="health-item"><span>Email Service</span><span class="warn">● Degraded</span></div>
            </div>
        </div>
    </aside>
</main>
</body>
<script src="{{ url_for('static', filename='app.js') }}" defer></script>
</html>
